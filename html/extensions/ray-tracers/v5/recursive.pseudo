trace(scene, ray)
  result = black

  find intersection between scene and ray

  result += compute_ambient
  result += compute_diffuse
  result += compute_specular
  result += compute_reflection

  return result


compute_reflection(...)
  if material is reflective
    ray' = compute reflection of ray
    return trace(scene, ray')
  else
    return black
