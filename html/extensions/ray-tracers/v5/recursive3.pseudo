trace(scene, ray, weight)
  result = black

  if weight > 0.01
    find intersection between scene and ray

    result += compute_ambient
    result += compute_diffuse
    result += compute_specular
    result += compute_reflection
    
  return result


compute_reflection(...)
  if material is reflective
    ray' = compute reflection of ray
    return reflectivity * trace(scene, ray', weight * reflectivity)
  else
    return black
