<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>3DCG: Refraction</title>
    <%= stylesheets('3dcg', 'box2') %>
    <%= scripts('jquery', 'jquery-ui', 'underscore', 'ace/ace', 'source-editor') %>
    <style>
      img.large {
        width: 60%;
      }

      #refractive-indices {
        margin: 10px auto;
      }

      #refractive-indices td {
        padding-right: 2em;
      }

      #refractive-indices th {
        text-align: left;
        background: #AAA;
        margin: 0.2em 1em;
        padding: 0.25em;
      }
    </style>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
  </head>

  <body>
    <header>
      Refraction
    </header>
    <div id="contents">
      <section>
        <h1>Explanation</h1>
        <p>
          When a light ray reaches a transparent material, part of it penetrates the material, at which
          point the light ray is bent in another direction. The following explanation is not very exact, but it helps
          to understand refraction intuitively.
        </p>
        <p>
          A light ray travels through a medium, for example air, water, glass, diamond, &hellip;
          Air is quite thin and photons can move through it mostly unhindered, meaning
          that a light beam travels through air at almost the speed of light.
          Diamonds, however, are very dense, making photons bump into carbon atoms all the time.
          As a consequence, a light beam is slowed down considerably, i.e. 2.42&times; slower than
          the "regular" speed of light.
        </p>
        <p>
          You can imagine a light ray as photons flying next to each other:
        </p>
        <%= tex_image 'lightray' %>
        <p>
          When a car's right wheels turn
          slower than its left wheels, the car will turn right. The same principle is true for the light ray.
          Consider the figure below. When the light ray reaches the new medium, say a denser one (so that it slows down),
          the lower photons arrive first and slow down while the upper photons still travel at full speed.
          This makes the ray make a right turn.
        </p>
        <%= tex_image 'medium' %>
        <p>
          If the second medium were less dense, the lower photons would start moving faster while the upper
          are still going slowly, resulting in a left turn.
        </p>
        <p>
          One way in which this explanation is faulty is that according to this model, if a photon
          were traveling alone, it would not bend, while in reality, it would.
        </p>
      </section>

      <section>
        <h1>Mathemetics</h1>
        <section>
          <h2>Snell's Law</h2>
          <p>
            Each transparent material is characterized by its <em>refractive index</em> $n$.
            This index corresponds by the factor by which light is slowed down when it travels
            through the material. Examples of refractive indices are
          </p>
          <table id="refractive-indices">
            <thead>
              <tr>
                <th>Medium</th>
                <th>Refractive Index</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Vacuum</td>
                <td>1</td>
              </tr>
              <tr>
                <td>Air</td>
                <td>1.000293</td>
              </tr>
              <tr>
                <td>Water</td>
                <td>1.3333</td>
              </tr>
              <tr>
                <td>Glass</td>
                <td>1.52</td>
              </tr>
            </tbody>
          </table>
          <p>
            To determine how a light ray is bent when it changes from a medium with refractive
            index $n_1$ to a medium with refractive index $n_2$, we use <a href="https://en.wikipedia.org/wiki/Snell%27s_law">Snell's law</a>.
            \[
               \frac{\sin \theta_1}{\sin \theta_2} = \frac{n_1}{n_2}
            \]
            where $\theta_1$ is the angle the light ray makes with the normal $\vec n$ on the contact surface between the two materials.
          </p>
          <%= tex_image 'snell' %>
          <p>
            So, given the refractive indices $n_1$ and $n_2$, and the incoming angle $\theta_1$, you can compute the outgoing angle $\theta_2$:
            \[
              \theta_2 = \sin^{-1}\left(\frac{n_2}{n_1} \sin\theta_1\right)
            \]
            There is one issue however: it is possible that $\frac{n_2}{n_1} \sin\theta_1 &gt; 1$, which makes it mathematically impossible
            to take the $sin^{-1}$ as it is only defined for values between $0$ and $1$. What actually happens in this case is
            <em>total internal reflection</em>: instead of traversing the contact surface, the light ray will bounce off of it, as if it is a mirror.
          </p>
        </section>
        <section>
          <h2>Using Vectors</h2>
          <p>
            In its current form Snell's law is not practical to use in our context.
            We rewrite it using vector math.
          </p>
          <p>
            The algorithm needs the following inputs:
          </p>
          <ul>
            <li>
              A unit vector $\vec i$ representing the direction of the incoming light.
              This vector should point towards the origin of the ray.
            </li>
            <li>
              The refractive indices of the materials $n_1$ and $n_2$.
            </li>
            <li>
              The unit normal vector $\vec n$ on the contact surface at the point where the light ray moves from the first to the second material.
            </li>
          </ul>
          <%= tex_image 'formula' %>
          <p>
            The outgoing direction of the ray can be found using the following formula:
            \[
              \begin{array}{rcl}
                \vec{o}_\mathrm{x} &amp; = &amp; \frac{n_1}{n_2} \cdot (\vec i - (\vec i \cdot \vec n) \cdot \vec n) \\
                \vec{o}_\mathrm{y} &amp; = &amp; -\sqrt{1-|\vec{o}_\mathrm{x}|^2} \cdot \vec n \\
                \vec{o} &amp; = &amp; \vec{o}_\mathrm{x} + \vec{o}_\mathrm{y} \\
              \end{array}
            \]
            You have to check whether $1-|\vec{o}_\mathrm{x}|^2 &lt; 0$. If this is the case, total internal reflection occurs.
          </p>
        </section>
      </section>
    </div>
  </body>
  <script>
    function initialize()
    {
      SourceEditor.initialize();
    }

    $( initialize );   
  </script>
</html>
