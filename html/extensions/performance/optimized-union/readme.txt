Rewrite union so that it does not split up into many binary unions
